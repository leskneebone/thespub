PREFIX orcid:   <https://orcid.org/>
PREFIX owl:     <http://www.w3.org/2002/07/owl#> 
PREFIX rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs:    <http://www.w3.org/2000/01/rdf-schema#>
PREFIX skos:    <http://www.w3.org/2004/02/skos/core#>
PREFIX sh:      <http://www.w3.org/ns/shacl#>
PREFIX req:     <https://w3id.org/requirement-ontology/rdl/>
PREFIX schema:  <https://schema.org/>
PREFIX thespub: <http://test.linked.data.gov.au/def/thespub>
PREFIX thesreq: <http://test.linked.data.gov.au/def/thespub#>
PREFIX thesval: <http://test.linked.data.gov.au/def/thespub/validator>
PREFIX thesshp: <http://test.linked.data.gov.au/def/thespub/validator#>
PREFIX vocval:  <https://linked.data.gov.au/def/vocpub/validator/>
PREFIX xsd:     <http://www.w3.org/2001/XMLSchema#> 

#################################################################
#  ThesPub Validator
#################################################################

thesval:
    a owl:Ontology , sh:ShapesGraph ;
    schema:name "ThesPub Validator"@en ;
    schema:definition "SHACL validator for the ThesPub Profile"@en ;
    schema:creator orcid:0000-0001-5640-3202 ;
    schema:dateCreated "2025-12-13"^^xsd:date ;
    schema:dateModified "2025-12-13"^^xsd:date ;
.

#################################################################
#  1. Override VocPub's label+definition requirement
#################################################################

# This is a NodeShape from VocPub SHACL:
#  vocval:Requirement-2.2.1
#   a sh:NodeShape ;
#   sh:targetClass skos:Concept ;
#   sh:message "... MUST have exactly one title and at least one definition ..." ;
#   sh:property skos:prefLabel , skos:definition ;

# In ThesPub validator we deactivate it so our shapes can take over.

vocval:Requirement-2.2.1
    sh:deactivated true .

#################################################################
#  2. THES-01 – at most one prefLabel per language
#################################################################

thesshp:OnePrefLabelPerLanguage
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:severity sh:Violation ;

    sh:property [
        sh:path skos:prefLabel ;
        sh:uniqueLang true ;
        sh:message "[THES-01] A concept MUST NOT have more than one skos:prefLabel per language tag."@en ;
    ] ;

    thespub:implements thesreq:THES-01 .

#################################################################
#  3. THES-02 – definition mandatory for top concept only
#################################################################

thesshp:TopConceptDefinition
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:severity sh:Violation ;

    sh:property [
        sh:path skos:topConceptOf ;
        sh:minCount 1 ;
        sh:qualifiedValueShape [
            sh:path skos:definition ;
            sh:minCount 1 ;
        ] ;
        sh:message "[THES-02] Top concepts MUST have a skos:definition."@en ;
    ] ;

    thespub:implements thesreq:THES-02 .


#################################################################
#  4. THES-03 – encourage at least one altLabel
#################################################################

thesshp:AltLabelRecommended
    a sh:NodeShape ;
    sh:targetClass skos:Concept ;
    sh:severity sh:Warning ;

    sh:property [
        sh:path skos:altLabel ;
        sh:minCount 1 ;
        sh:message "[THES-03] Consider adding at least one skos:altLabel; synonyms may improve usability."@en ;
    ] ;

    thespub:implements thesreq:THES-03 .
